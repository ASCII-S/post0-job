---
created: '2025-11-16'
last_reviewed: null
next_review: '2025-11-16'
review_count: 0
difficulty: medium
mastery_level: 0.0
tags:
- ç†Ÿæ‚‰python
- ç†Ÿæ‚‰python/å¸¸ç”¨å­—ç¬¦ä¸²æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦.md
related_outlines: []
---
# å¸¸ç”¨å­—ç¬¦ä¸²æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦

## é¢è¯•æ ‡å‡†ç­”æ¡ˆï¼ˆå¯èƒŒè¯µï¼‰

Python å­—ç¬¦ä¸²çš„å¸¸ç”¨æ–¹æ³•æ—¶é—´å¤æ‚åº¦å¦‚ä¸‹ï¼š**ç´¢å¼•è®¿é—®å’Œåˆ‡ç‰‡**æ˜¯ O(k)ï¼Œk ä¸ºåˆ‡ç‰‡é•¿åº¦ï¼›**æŸ¥æ‰¾æ–¹æ³•**ï¼ˆfindã€indexã€inï¼‰æ˜¯ O(n)ï¼Œä½¿ç”¨çº¿æ€§æœç´¢ï¼›**æ›¿æ¢æ–¹æ³•**ï¼ˆreplaceï¼‰æ˜¯ O(n)ï¼Œéœ€è¦éå†æ•´ä¸ªå­—ç¬¦ä¸²ï¼›**åˆ†å‰²å’Œè¿æ¥**ï¼ˆsplitã€joinï¼‰æ˜¯ O(n)ï¼›**å¤§å°å†™è½¬æ¢**ï¼ˆupperã€lowerï¼‰æ˜¯ O(n)ï¼›**å»é™¤ç©ºç™½**ï¼ˆstripï¼‰æ˜¯ O(n)ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPython å­—ç¬¦ä¸²æ˜¯**ä¸å¯å˜å¯¹è±¡**ï¼Œä»»ä½•ä¿®æ”¹æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°å­—ç¬¦ä¸²ï¼Œå› æ­¤é¢‘ç¹æ‹¼æ¥åº”ä½¿ç”¨ `join()` è€Œé `+` æ“ä½œç¬¦ï¼Œä»¥é¿å… O(nÂ²) çš„æ—¶é—´å¤æ‚åº¦ã€‚

---

## è¯¦ç»†è®²è§£

### 1. Python å­—ç¬¦ä¸²çš„åº•å±‚å®ç°

#### 1.1 å­—ç¬¦ä¸²çš„ä¸å¯å˜æ€§

```python
# Python å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜å¯¹è±¡ï¼ˆimmutableï¼‰
s = "hello"
# s[0] = 'H'  # TypeError: 'str' object does not support item assignment

# ä»»ä½•"ä¿®æ”¹"æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°å­—ç¬¦ä¸²
s2 = s.upper()  # åˆ›å»ºæ–°å­—ç¬¦ä¸² "HELLO"
print(id(s), id(s2))  # ä¸åŒçš„å†…å­˜åœ°å€
```

**åº•å±‚ç»“æ„ï¼ˆCPythonï¼‰ï¼š**
```c
typedef struct {
    PyObject_HEAD
    Py_ssize_t length;          // å­—ç¬¦ä¸²é•¿åº¦
    Py_hash_t hash;             // ç¼“å­˜çš„å“ˆå¸Œå€¼
    struct {
        unsigned int interned:2;  // å­—ç¬¦ä¸²é©»ç•™æ ‡å¿—
        unsigned int kind:3;      // ç¼–ç ç±»å‹ï¼ˆASCII/Latin1/UCS2/UCS4ï¼‰
        unsigned int compact:1;
        unsigned int ascii:1;
        unsigned int ready:1;
    } state;
    wchar_t *wstr;              // å­—ç¬¦æ•°æ®
} PyUnicodeObject;
```

#### 1.2 å­—ç¬¦ä¸²ç¼–ç 

```python
# Python 3 å­—ç¬¦ä¸²ä½¿ç”¨ Unicode
# æ ¹æ®å†…å®¹é€‰æ‹©æœ€ä¼˜ç¼–ç æ–¹å¼

# ASCII (1 byte per char)
s1 = "hello"

# Latin-1 (1 byte per char)
s2 = "cafÃ©"

# UCS-2 (2 bytes per char)
s3 = "ä½ å¥½"

# UCS-4 (4 bytes per char)
s4 = "ğ•³ğ–Šğ–‘ğ–‘ğ–”"  # æ•°å­¦å­—æ¯

import sys
print(sys.getsizeof(s1))  # è¾ƒå°
print(sys.getsizeof(s4))  # è¾ƒå¤§
```

### 2. è®¿é—®å’Œåˆ‡ç‰‡æ“ä½œ

#### 2.1 ç´¢å¼•è®¿é—®

| æ“ä½œ     | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜             |
| -------- | ---------- | ---------------- |
| `s[i]`   | O(1)       | ç›´æ¥é€šè¿‡ç´¢å¼•è®¿é—® |
| `s[-1]`  | O(1)       | è´Ÿç´¢å¼•ä¹Ÿæ˜¯ O(1)  |
| `len(s)` | O(1)       | é•¿åº¦å·²ç¼“å­˜       |

```python
s = "hello world"

# O(1) - ç´¢å¼•è®¿é—®
char = s[0]      # 'h'
last = s[-1]     # 'd'

# O(1) - è·å–é•¿åº¦
length = len(s)  # 11

# åŸç†ï¼šå­—ç¬¦ä¸²é•¿åº¦å­˜å‚¨åœ¨å¯¹è±¡å¤´éƒ¨
# ç´¢å¼•è®¿é—®é€šè¿‡ base_address + index * char_size è®¡ç®—
```

#### 2.2 åˆ‡ç‰‡æ“ä½œ

| æ“ä½œ     | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜                         |
| -------- | ---------- | ---------------------------- |
| `s[i:j]` | O(k)       | k = j - iï¼Œéœ€è¦å¤åˆ¶ k ä¸ªå­—ç¬¦ |
| `s[:]`   | O(n)       | å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²               |
| `s[::2]` | O(n)       | éœ€è¦éå†å¹¶å¤åˆ¶               |

```python
s = "hello world"

# O(k) - åˆ‡ç‰‡ï¼Œk ä¸ºåˆ‡ç‰‡é•¿åº¦
sub1 = s[0:5]    # "hello" - O(5)
sub2 = s[6:]     # "world" - O(5)
sub3 = s[::2]    # "hlowrd" - O(11)ï¼Œéœ€è¦éå†

# åˆ‡ç‰‡åˆ›å»ºæ–°å­—ç¬¦ä¸²
print(id(s), id(sub1))  # ä¸åŒåœ°å€

# æ€§èƒ½æµ‹è¯•
import timeit

def slice_short():
    return "a" * 1000000 [0:10]

def slice_long():
    return "a" * 1000000 [0:500000]

print(timeit.timeit(slice_short, number=10000))  # å¿«
print(timeit.timeit(slice_long, number=10000))   # æ…¢
```

### 3. æŸ¥æ‰¾å’Œæœç´¢æ–¹æ³•

#### 3.1 æŸ¥æ‰¾æ–¹æ³•æ—¶é—´å¤æ‚åº¦

| æ–¹æ³•                   | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜                     |
| ---------------------- | ---------- | ------------------------ |
| `s.find(sub)`          | O(n*m)     | n=å­—ç¬¦ä¸²é•¿åº¦ï¼Œm=å­ä¸²é•¿åº¦ |
| `s.index(sub)`         | O(n*m)     | åŒ findï¼Œæœªæ‰¾åˆ°æŠ›å¼‚å¸¸    |
| `sub in s`             | O(n*m)     | ä½¿ç”¨ä¼˜åŒ–çš„æœç´¢ç®—æ³•       |
| `s.count(sub)`         | O(n*m)     | éœ€è¦éå†æ•´ä¸ªå­—ç¬¦ä¸²       |
| `s.startswith(prefix)` | O(m)       | m=å‰ç¼€é•¿åº¦               |
| `s.endswith(suffix)`   | O(m)       | m=åç¼€é•¿åº¦               |

```python
s = "hello world hello python"

# O(n*m) - æŸ¥æ‰¾å­ä¸²
pos1 = s.find("world")        # 6
pos2 = s.find("java")         # -1 (æœªæ‰¾åˆ°)

# O(n*m) - index æ–¹æ³•ï¼ˆæœªæ‰¾åˆ°ä¼šæŠ›å¼‚å¸¸ï¼‰
try:
    pos3 = s.index("python")  # 18
    pos4 = s.index("java")    # ValueError
except ValueError:
    pass

# O(n*m) - in æ“ä½œç¬¦
exists = "hello" in s         # True

# O(n*m) - è®¡æ•°
count = s.count("hello")      # 2

# O(m) - å‰ç¼€/åç¼€æ£€æŸ¥
is_start = s.startswith("hello")  # True - O(5)
is_end = s.endswith("python")     # True - O(6)
```

#### 3.2 æŸ¥æ‰¾ç®—æ³•ä¼˜åŒ–

```python
# CPython ä½¿ç”¨ä¼˜åŒ–çš„å­—ç¬¦ä¸²æœç´¢ç®—æ³•
# å¯¹äºçŸ­å­—ç¬¦ä¸²ï¼šBrute Force
# å¯¹äºé•¿å­—ç¬¦ä¸²ï¼šBoyer-Moore-Horspool æˆ–ç±»ä¼¼ç®—æ³•

# æ€§èƒ½å¯¹æ¯”
import timeit

text = "a" * 1000000 + "b"

# æœ€åæƒ…å†µï¼šO(n*m)
def worst_case():
    return text.find("aaab")

# æœ€å¥½æƒ…å†µï¼šO(n)
def best_case():
    return text.find("b")

print(timeit.timeit(worst_case, number=100))  # è¾ƒæ…¢
print(timeit.timeit(best_case, number=100))   # è¾ƒå¿«
```

### 4. ä¿®æ”¹å’Œè½¬æ¢æ–¹æ³•

#### 4.1 å¤§å°å†™è½¬æ¢

| æ–¹æ³•             | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜         |
| ---------------- | ---------- | ------------ |
| `s.upper()`      | O(n)       | éå†æ‰€æœ‰å­—ç¬¦ |
| `s.lower()`      | O(n)       | éå†æ‰€æœ‰å­—ç¬¦ |
| `s.capitalize()` | O(n)       | éå†æ‰€æœ‰å­—ç¬¦ |
| `s.title()`      | O(n)       | éå†æ‰€æœ‰å­—ç¬¦ |
| `s.swapcase()`   | O(n)       | éå†æ‰€æœ‰å­—ç¬¦ |

```python
s = "Hello World"

# O(n) - å¤§å°å†™è½¬æ¢ï¼Œåˆ›å»ºæ–°å­—ç¬¦ä¸²
upper = s.upper()        # "HELLO WORLD"
lower = s.lower()        # "hello world"
title = s.title()        # "Hello World"
swap = s.swapcase()      # "hELLO wORLD"

# æ¯æ¬¡éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²
print(id(s), id(upper), id(lower))  # ä¸‰ä¸ªä¸åŒåœ°å€

# æ€§èƒ½æµ‹è¯•
import timeit

short_str = "hello"
long_str = "hello" * 100000

print(timeit.timeit(lambda: short_str.upper(), number=100000))  # å¿«
print(timeit.timeit(lambda: long_str.upper(), number=100000))   # æ…¢
```

#### 4.2 æ›¿æ¢æ–¹æ³•

| æ–¹æ³•                         | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜                    |
| ---------------------------- | ---------- | ----------------------- |
| `s.replace(old, new)`        | O(n*m)     | n=å­—ç¬¦ä¸²é•¿åº¦ï¼Œm=oldé•¿åº¦ |
| `s.replace(old, new, count)` | O(n*m)     | é™åˆ¶æ›¿æ¢æ¬¡æ•°            |

```python
s = "hello world hello python"

# O(n*m) - æ›¿æ¢æ‰€æœ‰åŒ¹é…
s1 = s.replace("hello", "hi")  # "hi world hi python"

# O(n*m) - é™åˆ¶æ›¿æ¢æ¬¡æ•°
s2 = s.replace("hello", "hi", 1)  # "hi world hello python"

# æ›¿æ¢ç©ºå­—ç¬¦ä¸²ï¼ˆåˆ é™¤ï¼‰
s3 = s.replace(" ", "")  # "helloworldhellopython"

# æ€§èƒ½åˆ†æ
def replace_test():
    text = "a" * 1000000
    return text.replace("a", "b")  # O(n)

import timeit
print(timeit.timeit(replace_test, number=10))
```

### 5. åˆ†å‰²å’Œè¿æ¥æ–¹æ³•

#### 5.1 åˆ†å‰²æ–¹æ³•

| æ–¹æ³•                     | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜             |
| ------------------------ | ---------- | ---------------- |
| `s.split()`              | O(n)       | æŒ‰ç©ºç™½åˆ†å‰²       |
| `s.split(sep)`           | O(n)       | æŒ‰æŒ‡å®šåˆ†éš”ç¬¦åˆ†å‰² |
| `s.split(sep, maxsplit)` | O(n)       | é™åˆ¶åˆ†å‰²æ¬¡æ•°     |
| `s.rsplit()`             | O(n)       | ä»å³ä¾§åˆ†å‰²       |
| `s.splitlines()`         | O(n)       | æŒ‰è¡Œåˆ†å‰²         |
| `s.partition(sep)`       | O(n)       | åˆ†å‰²ä¸ºä¸‰éƒ¨åˆ†     |

```python
s = "hello world python programming"

# O(n) - æŒ‰ç©ºç™½åˆ†å‰²
words = s.split()  # ['hello', 'world', 'python', 'programming']

# O(n) - æŒ‰æŒ‡å®šåˆ†éš”ç¬¦
csv = "a,b,c,d"
items = csv.split(",")  # ['a', 'b', 'c', 'd']

# O(n) - é™åˆ¶åˆ†å‰²æ¬¡æ•°
limited = s.split(" ", 2)  # ['hello', 'world', 'python programming']

# O(n) - ä»å³ä¾§åˆ†å‰²
right = s.rsplit(" ", 1)  # ['hello world python', 'programming']

# O(n) - åˆ†å‰²ä¸ºä¸‰éƒ¨åˆ†ï¼ˆåªåˆ†å‰²ä¸€æ¬¡ï¼‰
before, sep, after = s.partition("world")
# ('hello ', 'world', ' python programming')

# å¤šè¡Œæ–‡æœ¬
text = "line1\nline2\nline3"
lines = text.splitlines()  # ['line1', 'line2', 'line3']
```

#### 5.2 è¿æ¥æ–¹æ³•

| æ–¹æ³•                 | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜               |
| -------------------- | ---------- | ------------------ |
| `sep.join(iterable)` | O(n)       | n=æ‰€æœ‰å­—ç¬¦ä¸²æ€»é•¿åº¦ |
| `s1 + s2`            | O(n+m)     | åˆ›å»ºæ–°å­—ç¬¦ä¸²       |
| `s1 += s2` (å¾ªç¯ä¸­)  | O(nÂ²)      | æ¯æ¬¡åˆ›å»ºæ–°å­—ç¬¦ä¸²   |

```python
# O(n) - join æ–¹æ³•ï¼ˆæ¨èï¼‰
words = ['hello', 'world', 'python']
result1 = " ".join(words)  # "hello world python"

# join åªéå†ä¸€æ¬¡ï¼Œé¢„å…ˆè®¡ç®—æ€»é•¿åº¦
# æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œn ä¸ºæ‰€æœ‰å­—ç¬¦ä¸²æ€»é•¿åº¦

# O(nÂ²) - å¾ªç¯ä¸­ä½¿ç”¨ + æ‹¼æ¥ï¼ˆä¸æ¨èï¼‰
result2 = ""
for word in words:
    result2 += word + " "  # æ¯æ¬¡åˆ›å»ºæ–°å­—ç¬¦ä¸²

# æ€§èƒ½å¯¹æ¯”
import timeit

def join_method():
    words = ["hello"] * 10000
    return " ".join(words)

def plus_method():
    words = ["hello"] * 10000
    result = ""
    for word in words:
        result += word + " "
    return result

print("join:", timeit.timeit(join_method, number=100))   # å¿«
print("plus:", timeit.timeit(plus_method, number=100))   # æ…¢å¾ˆå¤š
```

**ä¸ºä»€ä¹ˆ join æ¯” + å¿«ï¼Ÿ**

```python
# + æ“ä½œç¬¦åœ¨å¾ªç¯ä¸­çš„é—®é¢˜
result = ""
for i in range(n):
    result += str(i)  # æ¯æ¬¡éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²
    
# ç¬¬ 1 æ¬¡ï¼šåˆ›å»ºé•¿åº¦ 1 çš„å­—ç¬¦ä¸²
# ç¬¬ 2 æ¬¡ï¼šåˆ›å»ºé•¿åº¦ 2 çš„å­—ç¬¦ä¸²ï¼ˆå¤åˆ¶å‰ 1 ä¸ªå­—ç¬¦ï¼‰
# ç¬¬ 3 æ¬¡ï¼šåˆ›å»ºé•¿åº¦ 3 çš„å­—ç¬¦ä¸²ï¼ˆå¤åˆ¶å‰ 2 ä¸ªå­—ç¬¦ï¼‰
# ...
# æ€»å¤åˆ¶æ¬¡æ•°ï¼š1 + 2 + 3 + ... + n = O(nÂ²)

# join æ–¹æ³•
result = "".join(str(i) for i in range(n))
# 1. éå†ä¸€æ¬¡è®¡ç®—æ€»é•¿åº¦ï¼šO(n)
# 2. åˆ†é…ä¸€æ¬¡å†…å­˜ï¼šO(1)
# 3. å¤åˆ¶æ‰€æœ‰å­—ç¬¦ï¼šO(n)
# æ€»æ—¶é—´ï¼šO(n)
```

### 6. å»é™¤å’Œå¡«å……æ–¹æ³•

#### 6.1 å»é™¤ç©ºç™½

| æ–¹æ³•             | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜         |
| ---------------- | ---------- | ------------ |
| `s.strip()`      | O(n)       | å»é™¤ä¸¤ç«¯ç©ºç™½ |
| `s.lstrip()`     | O(n)       | å»é™¤å·¦ä¾§ç©ºç™½ |
| `s.rstrip()`     | O(n)       | å»é™¤å³ä¾§ç©ºç™½ |
| `s.strip(chars)` | O(n)       | å»é™¤æŒ‡å®šå­—ç¬¦ |

```python
s = "  hello world  \n"

# O(n) - å»é™¤ä¸¤ç«¯ç©ºç™½
clean = s.strip()    # "hello world"

# O(n) - å»é™¤å·¦ä¾§
left = s.lstrip()    # "hello world  \n"

# O(n) - å»é™¤å³ä¾§
right = s.rstrip()   # "  hello world"

# O(n) - å»é™¤æŒ‡å®šå­—ç¬¦
s2 = "***hello***"
clean2 = s2.strip("*")  # "hello"

# å®ç°åŸç†ï¼šä»ä¸¤ç«¯å‘ä¸­é—´æ‰«æ
def my_strip(s):
    # æ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦
    start = 0
    while start < len(s) and s[start].isspace():
        start += 1
    
    # æ‰¾åˆ°æœ€åä¸€ä¸ªéç©ºç™½å­—ç¬¦
    end = len(s) - 1
    while end >= start and s[end].isspace():
        end -= 1
    
    return s[start:end+1]
```

#### 6.2 å¡«å……æ–¹æ³•

| æ–¹æ³•              | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜       |
| ----------------- | ---------- | ---------- |
| `s.ljust(width)`  | O(n)       | å·¦å¯¹é½å¡«å…… |
| `s.rjust(width)`  | O(n)       | å³å¯¹é½å¡«å…… |
| `s.center(width)` | O(n)       | å±…ä¸­å¡«å……   |
| `s.zfill(width)`  | O(n)       | ç”¨ 0 å¡«å……  |

```python
s = "hello"

# O(n) - å·¦å¯¹é½ï¼ˆå³ä¾§å¡«å……ï¼‰
left = s.ljust(10)       # "hello     "
left2 = s.ljust(10, "*") # "hello*****"

# O(n) - å³å¯¹é½ï¼ˆå·¦ä¾§å¡«å……ï¼‰
right = s.rjust(10)      # "     hello"
right2 = s.rjust(10, "*")# "*****hello"

# O(n) - å±…ä¸­
center = s.center(10)    # "  hello   "

# O(n) - æ•°å­—å¡«å…… 0
num = "42"
padded = num.zfill(5)    # "00042"
```

### 7. æ£€æŸ¥å’ŒéªŒè¯æ–¹æ³•

#### 7.1 å†…å®¹æ£€æŸ¥

| æ–¹æ³•          | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜                   |
| ------------- | ---------- | ---------------------- |
| `s.isalpha()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯å­—æ¯       |
| `s.isdigit()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯æ•°å­—       |
| `s.isalnum()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯å­—æ¯æˆ–æ•°å­— |
| `s.isspace()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯ç©ºç™½       |
| `s.isupper()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯å¤§å†™       |
| `s.islower()` | O(n)       | æ£€æŸ¥æ˜¯å¦å…¨æ˜¯å°å†™       |

```python
# O(n) - æ‰€æœ‰æ£€æŸ¥æ–¹æ³•éƒ½éœ€è¦éå†å­—ç¬¦ä¸²

s1 = "hello"
print(s1.isalpha())   # True
print(s1.isdigit())   # False

s2 = "12345"
print(s2.isdigit())   # True
print(s2.isalnum())   # True

s3 = "hello123"
print(s3.isalnum())   # True
print(s3.isalpha())   # False

# å®ç°åŸç†
def my_isdigit(s):
    if not s:
        return False
    for char in s:  # O(n)
        if not '0' <= char <= '9':
            return False
    return True
```

### 8. ç¼–ç å’Œè§£ç 

#### 8.1 ç¼–ç æ–¹æ³•

| æ–¹æ³•             | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜         |
| ---------------- | ---------- | ------------ |
| `s.encode()`     | O(n)       | å­—ç¬¦ä¸²è½¬å­—èŠ‚ |
| `bytes.decode()` | O(n)       | å­—èŠ‚è½¬å­—ç¬¦ä¸² |

```python
# O(n) - ç¼–ç 
s = "ä½ å¥½ä¸–ç•Œ"
utf8_bytes = s.encode('utf-8')      # b'\xe4\xbd\xa0\xe5\xa5\xbd...'
gbk_bytes = s.encode('gbk')         # ä¸åŒç¼–ç 

# O(n) - è§£ç 
decoded = utf8_bytes.decode('utf-8')  # "ä½ å¥½ä¸–ç•Œ"

# ä¸åŒç¼–ç çš„å­—èŠ‚é•¿åº¦ä¸åŒ
print(len(s))           # 4 (å­—ç¬¦æ•°)
print(len(utf8_bytes))  # 12 (UTF-8: æ¯ä¸ªä¸­æ–‡3å­—èŠ‚)
print(len(gbk_bytes))   # 8 (GBK: æ¯ä¸ªä¸­æ–‡2å­—èŠ‚)
```

### 9. æ ¼å¼åŒ–æ–¹æ³•

#### 9.1 æ ¼å¼åŒ–æ—¶é—´å¤æ‚åº¦

| æ–¹æ³•         | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜                 |
| ------------ | ---------- | -------------------- |
| `s.format()` | O(n)       | æ ¼å¼åŒ–å­—ç¬¦ä¸²         |
| `f-string`   | O(n)       | æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆæ¨èï¼‰ |
| `%` æ ¼å¼åŒ–   | O(n)       | æ—§å¼æ ¼å¼åŒ–           |

```python
# O(n) - format æ–¹æ³•
name = "Alice"
age = 30
s1 = "Name: {}, Age: {}".format(name, age)

# O(n) - f-stringï¼ˆPython 3.6+ï¼Œæ¨èï¼‰
s2 = f"Name: {name}, Age: {age}"

# O(n) - % æ ¼å¼åŒ–ï¼ˆæ—§å¼ï¼‰
s3 = "Name: %s, Age: %d" % (name, age)

# æ€§èƒ½å¯¹æ¯”
import timeit

def format_method():
    return "Hello {}".format("world")

def f_string_method():
    world = "world"
    return f"Hello {world}"

def percent_method():
    return "Hello %s" % "world"

print("format:", timeit.timeit(format_method, number=1000000))
print("f-string:", timeit.timeit(f_string_method, number=1000000))  # æœ€å¿«
print("percent:", timeit.timeit(percent_method, number=1000000))
```

### 10. æ—¶é—´å¤æ‚åº¦æ€»ç»“è¡¨

#### 10.1 å®Œæ•´æ—¶é—´å¤æ‚åº¦è¡¨

| æ“ä½œç±»åˆ« | æ–¹æ³•             | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ |
| -------- | ---------------- | ---------- | ---------- |
| **è®¿é—®** | `s[i]`           | O(1)       | O(1)       |
|          | `len(s)`         | O(1)       | O(1)       |
|          | `s[i:j]`         | O(k)       | O(k)       |
| **æŸ¥æ‰¾** | `s.find(sub)`    | O(n*m)     | O(1)       |
|          | `sub in s`       | O(n*m)     | O(1)       |
|          | `s.count(sub)`   | O(n*m)     | O(1)       |
|          | `s.startswith()` | O(m)       | O(1)       |
| **è½¬æ¢** | `s.upper()`      | O(n)       | O(n)       |
|          | `s.lower()`      | O(n)       | O(n)       |
|          | `s.replace()`    | O(n*m)     | O(n)       |
| **åˆ†å‰²** | `s.split()`      | O(n)       | O(n)       |
|          | `sep.join()`     | O(n)       | O(n)       |
| **å»é™¤** | `s.strip()`      | O(n)       | O(n)       |
| **æ£€æŸ¥** | `s.isdigit()`    | O(n)       | O(1)       |
| **æ‹¼æ¥** | `s1 + s2`        | O(n+m)     | O(n+m)     |
|          | `s += t` (å¾ªç¯)  | O(nÂ²)      | O(nÂ²)      |

### 11. æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 11.1 å­—ç¬¦ä¸²æ‹¼æ¥ä¼˜åŒ–

```python
# âŒ ä¸æ¨èï¼šå¾ªç¯ä¸­ä½¿ç”¨ +
def bad_concat(items):
    result = ""
    for item in items:
        result += str(item)  # O(nÂ²)
    return result

# âœ… æ¨èï¼šä½¿ç”¨ join
def good_concat(items):
    return "".join(str(item) for item in items)  # O(n)

# âœ… æ¨èï¼šä½¿ç”¨åˆ—è¡¨ç´¯ç§¯
def good_concat2(items):
    parts = []
    for item in items:
        parts.append(str(item))
    return "".join(parts)  # O(n)

# âœ… æ¨èï¼šä½¿ç”¨ io.StringIO
from io import StringIO

def good_concat3(items):
    buffer = StringIO()
    for item in items:
        buffer.write(str(item))
    return buffer.getvalue()  # O(n)

# æ€§èƒ½æµ‹è¯•
import timeit

items = range(10000)
print("bad:", timeit.timeit(lambda: bad_concat(items), number=10))
print("good:", timeit.timeit(lambda: good_concat(items), number=10))
```

#### 11.2 å­—ç¬¦ä¸²æŸ¥æ‰¾ä¼˜åŒ–

```python
# å¤šæ¬¡æŸ¥æ‰¾åŒä¸€å­ä¸²
text = "hello world " * 1000

# âŒ ä¸æ¨èï¼šå¤šæ¬¡è°ƒç”¨ find
def multiple_finds():
    positions = []
    for i in range(100):
        pos = text.find("world")
        positions.append(pos)
    return positions

# âœ… æ¨èï¼šç¼“å­˜ç»“æœ
def cached_find():
    pos = text.find("world")
    return [pos] * 100

# âœ… æ¨èï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¤æ‚æ¨¡å¼ï¼‰
import re

def regex_find():
    pattern = re.compile(r"world")
    return [m.start() for m in pattern.finditer(text)]
```

#### 11.3 å­—ç¬¦ä¸²æ¯”è¾ƒä¼˜åŒ–

```python
# å¤§å°å†™ä¸æ•æ„Ÿæ¯”è¾ƒ

# âŒ ä¸æ¨èï¼šæ¯æ¬¡éƒ½è½¬æ¢
def bad_compare(s1, s2):
    return s1.lower() == s2.lower()  # æ¯æ¬¡éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²

# âœ… æ¨èï¼šä½¿ç”¨ casefoldï¼ˆæ›´å‡†ç¡®ï¼‰
def good_compare(s1, s2):
    return s1.casefold() == s2.casefold()

# âœ… æ¨èï¼šå…ˆæ¯”è¾ƒé•¿åº¦
def better_compare(s1, s2):
    if len(s1) != len(s2):  # O(1)
        return False
    return s1.casefold() == s2.casefold()  # O(n)

# å‰ç¼€/åç¼€æ£€æŸ¥
# âœ… ä½¿ç”¨ä¸“é—¨æ–¹æ³•
if text.startswith("hello"):  # O(m)ï¼Œm ä¸ºå‰ç¼€é•¿åº¦
    pass

# âŒ ä¸è¦ä½¿ç”¨åˆ‡ç‰‡æ¯”è¾ƒ
if text[:5] == "hello":  # O(5)ï¼Œä½†åˆ›å»ºäº†æ–°å­—ç¬¦ä¸²
    pass
```

#### 11.4 å­—ç¬¦ä¸²æ„å»ºä¼˜åŒ–

```python
# æ„å»ºå¤§å‹å­—ç¬¦ä¸²

# âŒ ä¸æ¨è
def build_html_bad():
    html = "<html>"
    html += "<body>"
    html += "<h1>Title</h1>"
    # ... æ›´å¤šå†…å®¹
    html += "</body>"
    html += "</html>"
    return html

# âœ… æ¨èï¼šä½¿ç”¨åˆ—è¡¨
def build_html_good():
    parts = [
        "<html>",
        "<body>",
        "<h1>Title</h1>",
        # ... æ›´å¤šå†…å®¹
        "</body>",
        "</html>"
    ]
    return "".join(parts)

# âœ… æ¨èï¼šä½¿ç”¨æ¨¡æ¿
from string import Template

def build_html_template():
    template = Template("""
    <html>
        <body>
            <h1>$title</h1>
        </body>
    </html>
    """)
    return template.substitute(title="Title")
```

### 12. å®é™…åº”ç”¨åœºæ™¯

#### 12.1 æ—¥å¿—å¤„ç†

```python
# åœºæ™¯ï¼šå¤„ç†å¤§é‡æ—¥å¿—è¡Œ

# âŒ ä½æ•ˆæ–¹å¼
def process_logs_bad(log_file):
    result = ""
    with open(log_file) as f:
        for line in f:
            if "ERROR" in line:  # O(n)
                result += line   # O(nÂ²)
    return result

# âœ… é«˜æ•ˆæ–¹å¼
def process_logs_good(log_file):
    errors = []
    with open(log_file) as f:
        for line in f:
            if "ERROR" in line:
                errors.append(line)
    return "".join(errors)  # O(n)

# âœ… æ›´å¥½ï¼šä½¿ç”¨ç”Ÿæˆå™¨
def process_logs_best(log_file):
    with open(log_file) as f:
        return "".join(line for line in f if "ERROR" in line)
```

#### 12.2 CSV å¤„ç†

```python
# åœºæ™¯ï¼šè§£æ CSV æ•°æ®

# âŒ æ‰‹åŠ¨åˆ†å‰²ï¼ˆä¸æ¨èï¼‰
def parse_csv_bad(csv_string):
    lines = csv_string.split("\n")  # O(n)
    result = []
    for line in lines:
        fields = line.split(",")     # O(m)
        result.append(fields)
    return result

# âœ… ä½¿ç”¨ csv æ¨¡å—
import csv
from io import StringIO

def parse_csv_good(csv_string):
    return list(csv.reader(StringIO(csv_string)))
```

#### 12.3 URL å¤„ç†

```python
# åœºæ™¯ï¼šæ„å»º URL æŸ¥è¯¢å­—ç¬¦ä¸²

# âŒ æ‰‹åŠ¨æ‹¼æ¥
def build_query_bad(params):
    query = "?"
    for key, value in params.items():
        query += f"{key}={value}&"
    return query[:-1]  # å»é™¤æœ€åçš„ &

# âœ… ä½¿ç”¨ urllib
from urllib.parse import urlencode

def build_query_good(params):
    return "?" + urlencode(params)

# ç¤ºä¾‹
params = {"name": "Alice", "age": 30, "city": "NYC"}
print(build_query_good(params))
# ?name=Alice&age=30&city=NYC
```

---

## æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **åŸºæœ¬æ“ä½œå¤æ‚åº¦**ï¼š
   - ç´¢å¼•è®¿é—®ï¼šO(1)
   - åˆ‡ç‰‡ï¼šO(k)
   - æŸ¥æ‰¾ï¼šO(n*m)
   - ä¿®æ”¹ï¼šO(n)ï¼ˆåˆ›å»ºæ–°å­—ç¬¦ä¸²ï¼‰

2. **å­—ç¬¦ä¸²ä¸å¯å˜æ€§**ï¼š
   - ä»»ä½•ä¿®æ”¹éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²
   - å¾ªç¯ä¸­ä½¿ç”¨ `+=` ä¼šå¯¼è‡´ O(nÂ²)

3. **æ‹¼æ¥ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨ `join()` è€Œé `+`
   - ä½¿ç”¨åˆ—è¡¨ç´¯ç§¯å† join
   - ä½¿ç”¨ `io.StringIO` å¤„ç†å¤§é‡æ‹¼æ¥

4. **æŸ¥æ‰¾ä¼˜åŒ–**ï¼š
   - ç¼“å­˜é‡å¤æŸ¥æ‰¾ç»“æœ
   - ä½¿ç”¨ `startswith/endswith` æ£€æŸ¥å‰åç¼€
   - å¤