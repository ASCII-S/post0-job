---
created: '2025-10-19'
last_reviewed: null
next_review: '2025-10-19'
review_count: 0
difficulty: medium
mastery_level: 0.0
tags:
- C++
- C++/尾置返回类型的作用.md
related_outlines: []
---
### 背景问题

在 C++ 里，函数返回值通常写在函数名前面：

```cpp
int add(int a, int b);
```

但是在泛型编程里，返回类型有时依赖于参数类型，写在前面就会显得很笨拙甚至写不出来。例如：

```cpp
template <typename T, typename U>
??? add(T t, U u) {
    return t + u;
}
```

这里 `???` 要填什么？返回类型其实取决于 `t + u` 的结果，但 `decltype(t + u)` 在函数体之后才能知道。

---

### 尾置返回类型的语法

C++11 允许把返回类型放到参数列表之后，用 `->` 引导：

```cpp
template <typename T, typename U>
auto add(T t, U u) -> decltype(t + u) {
    return t + u;
}
```

这样一来，返回值就可以用参数名来推导。

---

### 常见用途

1. **依赖参数的返回类型**：泛型函数里很常见。
2. **简化复杂类型声明**：比如函数返回迭代器、函数指针等长得很怪的类型。
3. **配合 `auto`**：C++14 之后支持函数返回 `auto` 并自动推导，但在 C++11 里如果想推导，就必须写尾置返回类型。

---

### 示例

```cpp
#include <vector>
#include <iostream>

template <typename Container>
auto get_first(Container& c) -> decltype(c.begin()) {
    return c.begin();
}

int main() {
    std::vector<int> v = {1,2,3};
    auto it = get_first(v);
    std::cout << *it << std::endl;  // 输出 1
}
```

---

### 一句话总结

尾置返回类型的作用是：**把返回类型声明延后到参数列表之后，以便能使用参数名进行类型推导，尤其适用于模板和复杂类型场景**。

---

## 相关笔记
<!-- 自动生成 -->

暂无相关笔记

